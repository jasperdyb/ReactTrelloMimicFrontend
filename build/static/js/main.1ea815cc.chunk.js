(this.webpackJsonptodo=this.webpackJsonptodo||[]).push([[0],{50:function(e,t,n){e.exports=n(68)},55:function(e,t,n){},56:function(e,t,n){},61:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},68:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(42),i=n.n(r),c=(n(55),n(56),n(73)),d=n(37),u=n(72),l="todo",s=n(7),f=n(3),m=n.n(f),p=n(43),h=n(44),O=(n(61),o.a.forwardRef((function(e,t){var n=e.todo,r=e.index,i=(e.isDragging,e.hideOnDrag,e.isDragOver,e.setQuickEditStates),c=(e.quickTodoEditRef,Object(a.useState)(!1)),d=Object(s.a)(c,2),u=d[0],l=d[1],f=function(e){e.preventDefault();var a=t.current.getBoundingClientRect(),o=a.top,c=a.left,d=a.width;i({show:!0,dimensions:{top:o,left:c,width:d},value:n.name,index:r})};return o.a.createElement("div",{ref:t,onMouseEnter:function(){l(!0)},onMouseLeave:function(){l(!1)},className:"btn d-flex todo-item"}," ",o.a.createElement("div",{className:"text-left mb-1 todo-text"},n.name),u?o.a.createElement("button",{onClick:f,onContextMenu:f,className:"edit mr-1"},o.a.createElement(p.a,{icon:h.a})):null)})));O.propTypes={todo:m.a.object,index:m.a.number,isDragging:m.a.bool,hideOnDrag:m.a.bool,isDragOver:m.a.bool,setQuickEditStates:m.a.func,quickTodoEditRef:m.a.object};var v=O;function b(e){var t=e.todo,n={transform:"rotate(5deg)",WebkitTransform:"rotate(5deg)",width:e.width,height:e.height};return o.a.createElement("div",{style:n},o.a.createElement(v,{todo:t}))}b.propTypes={todo:m.a.object,width:m.a.number,height:m.a.number};var T={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0};function E(e,t){if(!e||!t)return{display:"none"};var n=t.x,a=t.y,o="translate(".concat(n,"px, ").concat(a,"px)");return{transform:o,WebkitTransform:o}}var g=function(){var e=Object(u.a)((function(e){return{item:e.getItem(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}})),t=e.itemType,n=e.isDragging,a=e.item,r=e.initialOffset,i=e.currentOffset;return n?o.a.createElement("div",{style:T},o.a.createElement("div",{style:E(r,i)},function(){switch(t){case l:return o.a.createElement(b,{todo:a.todo,width:a.width,height:a.height});default:return null}}())):null},D=n(28),w=n(17),j=n.n(w),y=n(16),N=n(29),k=n(46),x=n(74),S=n(75),_=n(41);function L(e){var t=e.todo,n=e.index,r=e.handleMoveTodo,i=e.hideOnDrag,c=e.setHideOnDrag,d=e.setQuickEditStates,u=e.quickTodoEditRef,f=Object(a.useRef)(),m=Object(a.useState)({width:0,height:0}),p=Object(s.a)(m,2),h=p[0],O=p[1],b=Object(a.useState)(!1),T=Object(s.a)(b,2),E=T[0],g=T[1],D=Object(x.a)({item:{type:l,todo:t,index:n,width:h.width,height:h.height},begin:function(){setTimeout((function(){g(!0)}),10)},end:function(){g(!1),c(!1)},collect:function(e){return{isDragging:e.isDragging()}}}),w=Object(s.a)(D,3),j=w[0].isDragging,N=w[1],k=w[2],L=Object(S.a)({accept:l,drop:function(e){g(!1),r(e,n,"middle"),O({width:e.width,height:e.height})},collect:function(e){return{isDragOver:!!e.isOver(),item:e.getItem(),canDrop:e.canDrop()}},hover:function(){c(Q)},canDrop:function(e){return e.index!==n}}),I=Object(s.a)(L,2),q=I[0],M=q.isDragOver,R=q.item,Q=q.canDrop,A=I[1];Object(a.useEffect)((function(){k(Object(_.a)(),{captureDraggingState:!0})}),[]),Object(a.useEffect)((function(){f.current&&O({width:f.current.offsetWidth,height:f.current.offsetHeight})}),[t]);if(E)return i?o.a.createElement("div",null):o.a.createElement("div",{className:"p-2 pb-0"},o.a.createElement("span",{style:{height:R.height},className:"btn d-flex todo-blank"}," "));var C={todo:t,index:n,isDragging:j,hideOnDrag:i,isDragOver:M,setQuickEditStates:d,quickTodoEditRef:u};return o.a.createElement("div",{ref:A},o.a.createElement("div",{className:"p-2"},o.a.createElement("div",{ref:N,onMouseOver:function(){},onMouseLeave:function(){}},o.a.createElement(v,Object(y.a)({ref:f},C)))),M&&Q?o.a.createElement("div",{className:"p-2 pb-0"},o.a.createElement("span",{style:{height:R.height},className:"btn d-flex todo-blank"}," ")):null)}function I(e){var t=e.title,n=e.handleMoveTodo,a=e.setHideOnDrag,r=Object(S.a)({accept:l,drop:function(e){return n(e,0,"top")},collect:function(e){return{isOverOnTop:!!e.isOver(),item:e.getItem(),canDrop:e.canDrop()}},hover:function(){a(f)},canDrop:function(e){return 0!==e.index}}),i=Object(s.a)(r,2),c=i[0],d=c.isOverOnTop,u=c.item,f=c.canDrop,m=i[1];return o.a.createElement("div",{ref:m},o.a.createElement("div",{className:"card-header"},o.a.createElement("h5",{className:"card-title"},t)),d&&f?o.a.createElement("div",{className:"card-body p-2"},o.a.createElement("span",{href:"#",style:{height:u.height},className:"btn d-flex todo-blank"}," ")):null)}function q(e){var t=e.listLength,n=e.handleMoveTodo,a=e.setHideOnDrag,r=e.showNewTodo,i=e.handleShowNewTodo,c=e.handlePreventNewTodoOnBlur,d=e.handleAddNewTodo,u=Object(S.a)({accept:l,drop:function(e){return n(e,-1,"bottom")},collect:function(e){return{isOverOnBottom:!!e.isOver(),item:e.getItem(),canDrop:e.canDrop()}},hover:function(){a(O)},canDrop:function(e){return e.index!==t-1}}),f=Object(s.a)(u,2),m=f[0],p=m.isOverOnBottom,h=m.item,O=m.canDrop,v=f[1];return o.a.createElement("div",{ref:v},p&&O?o.a.createElement("div",{className:"card-body p-2"},o.a.createElement("span",{style:{height:h.height},className:"btn d-flex todo-blank"},"  ")):null,o.a.createElement("div",{className:"card-footer"},r?o.a.createElement("button",{onMouseDown:c,onClick:d,className:"btn btn-success"},"New todo"):o.a.createElement("button",{onClick:i,className:"btn btn-light"},"+ Add todo")))}L.propTypes={todo:m.a.object,index:m.a.number,handleMoveTodo:m.a.func,hideOnDrag:m.a.bool,setHideOnDrag:m.a.func,setQuickEditStates:m.a.func,quickTodoEditRef:m.a.object},I.propTypes={title:m.a.string,handleMoveTodo:m.a.func,setHideOnDrag:m.a.func},q.propTypes={listLength:m.a.number,handleMoveTodo:m.a.func,setHideOnDrag:m.a.func,showNewTodo:m.a.bool,handleShowNewTodo:m.a.func,handlePreventNewTodoOnBlur:m.a.func,handleAddNewTodo:m.a.func};var M=o.a.forwardRef((function(e,t){var n=e.handleNewTodoOnBlur,r=e.setNewTodo;Object(a.useLayoutEffect)((function(){t.current.focus()}),[t]);return o.a.createElement("div",{className:"p-2 input-group"},o.a.createElement("textarea",{name:"new",ref:t,onBlur:n,onChange:function(e){r(e.target.value)},className:"form-control"}))}));M.propTypes={handleNewTodoOnBlur:m.a.func,setNewTodo:m.a.func};var R=M;n(64);function Q(e){var t=e.index,n=e.handleDeleteTodo;return o.a.createElement("div",{className:"options"},o.a.createElement("ul",{className:"p-1"},o.a.createElement("li",null,o.a.createElement("button",{onClick:function(e){return n(t)},className:"option-button"},"Delete"))))}Q.propTypes={index:m.a.number,handleDeleteTodo:m.a.func};n(65);var A=o.a.forwardRef((function(e,t){var n=e.quickEditStates,r=e.editedTodo,i=e.setEditedTodo,c=e.handleUpdateTodo,d=e.handleDeleteTodo,u=Object(D.a)({position:"relative",margin:0},n.dimensions);Object(a.useEffect)((function(){i(n.value),t.current.focus()}),[i,n,t]);return o.a.createElement("div",{id:"quickTodoEditTextarea",style:u,onClick:function(e){e.stopPropagation()}},o.a.createElement("div",{className:"textarea-size"},o.a.createElement("textarea",{ref:t,value:r,onFocus:function(e){var t=e.target;setTimeout((function(){return t.select()}),0)},onChange:function(e){i(e.target.value)},className:"form-control"})),o.a.createElement("button",{onClick:function(e){c(n.index,r)},className:"btn btn-success mt-2 save-button"},"Save"),o.a.createElement(Q,{index:n.index,handleDeleteTodo:d}))}));A.propTypes={quickEditStates:m.a.object,editedTodo:m.a.string,setEditedTodo:m.a.func,handleUpdateTodo:m.a.func,handleDeleteTodo:m.a.func};var C=A,$=(n(66),o.a.forwardRef((function(e,t){var n=e.quickEditStates,r=(e.setQuickEditStates,e.handleUpdateTodo),i=e.handleDeleteTodo,c=Object(a.useState)(""),d=Object(s.a)(c,2),u=d[0],l=d[1],f={quickEditStates:n,editedTodo:u,setEditedTodo:l,handleUpdateTodo:r,handleDeleteTodo:i};return o.a.createElement("div",{id:"quickTodoEdit",onClick:function(e){r(n.index,u)}},o.a.createElement(C,Object(y.a)({ref:t},f)))})));$.propTypes={quickEditStates:m.a.object,setQuickEditStates:m.a.func,handleUpdateTodo:m.a.func,handleDeleteTodo:m.a.func};var B=$,U=n(20),H=n(15),P=n.n(H);function G(){var e=Object(U.a)(["\n    {\n      list {\n        id\n        name\n        order\n      }\n    }\n  "]);return G=function(){return e},e}var W={GET_TODO_LIST:P()(G())};function z(){var e=Object(U.a)(["\n    mutation DeleteTodo($id: ID!) {\n      deleteTodo(id: $id) {\n        id\n      }\n    }\n  "]);return z=function(){return e},e}function J(){var e=Object(U.a)(["\n    mutation UpdateListOrder($newOrder: [Order!]!) {\n      updateListOrder(newOrder: $newOrder) {\n        id\n        order\n        name\n        finished\n      }\n    }\n  "]);return J=function(){return e},e}function F(){var e=Object(U.a)(["\n    mutation UpdateTodoName($id: ID!, $name: String!) {\n      updateTodoName(id: $id, name: $name) {\n        id\n        name\n      }\n    }\n  "]);return F=function(){return e},e}function K(){var e=Object(U.a)(["\n    mutation AddTodo($name: String!, $order: Int!) {\n      addTodo(name: $name, order: $order) {\n        id\n        name\n        order\n      }\n    }\n  "]);return K=function(){return e},e}var V={ADD_TODO:P()(K()),UPDATE_TODO_NAME:P()(F()),UPDATE_LIST_ORDER:P()(J()),DELETE_TODO:P()(z())},X=n(21);function Y(e){var t=e.todoItems,n=Object(a.useState)(!1),r=Object(s.a)(n,2),i=r[0],c=r[1],d=Object(a.useState)(!1),u=Object(s.a)(d,2),f=u[0],m=u[1],p=Object(a.useState)(""),h=Object(s.a)(p,2),O=h[0],v=h[1],b=Object(a.useState)({show:!1,dimensions:{top:0,left:0,width:0},value:"",index:-1}),T=Object(s.a)(b,2),E=T[0],g=T[1],w=Object(X.a)(V.ADD_TODO,{update:function(e,t){var n=t.data.addTodo,a=e.readQuery({query:W.GET_TODO_LIST}).list;e.writeQuery({query:W.GET_TODO_LIST,data:{list:a.concat([n])}})}}),x=Object(s.a)(w,1)[0],_=Object(X.a)(V.UPDATE_TODO_NAME),M=Object(s.a)(_,1)[0],Q=Object(X.a)(V.DELETE_TODO,{update:function(e,t){var n=t.data.deleteTodo,a=e.readQuery({query:W.GET_TODO_LIST}).list;e.writeQuery({query:W.GET_TODO_LIST,data:{list:a.filter((function(e){return e.id!==n.id}))}})}}),A=Object(s.a)(Q,1)[0],C=Object(X.a)(V.UPDATE_LIST_ORDER,{update:function(e,t){var n=t.data.updateListOrder;e.writeQuery({query:W.GET_TODO_LIST,data:{list:n}})}}),$=Object(s.a)(C,1)[0],U=Object(a.useRef)(null),H=Object(a.useRef)(null),P=!0,G=Object(S.a)({accept:l,drop:function(e){c(!1)}}),z=Object(s.a)(G,2);Object(k.a)(z[0]);var J=z[1];function F(e,t,n){return K.apply(this,arguments)}function K(){return(K=Object(N.a)(j.a.mark((function e(n,a,o){var r,i,c,d;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.map((function(e){return e.id})),i=n.index,c=r.splice(i,1),e.t0=o,e.next="top"===e.t0?6:"bottom"===e.t0?8:10;break;case 6:return r=c.concat(r),e.abrupt("break",13);case 8:return r=r.concat(c),e.abrupt("break",13);case 10:d=[],d=i<a?r.splice(a):r.splice(a+1),r=r.concat(c).concat(d);case 13:return r=r.map((function(e,t){return{id:e,order:t}})),e.next=16,$({variables:{newOrder:r}});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return Z.apply(this,arguments)}function Z(){return(Z=Object(N.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.length,typeof t.length),e.next=3,x({variables:{name:O,order:t.length}});case 3:v(""),P=!0,m(!1);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){return(ee=Object(N.a)(j.a.mark((function e(n,a){var o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t[n]===a||!a){e.next=5;break}return o=t[n].id,e.next=4,M({variables:{id:o,name:a}});case 4:g(Object(D.a)(Object(D.a)({},E),{},{value:""}));case 5:g({show:!1});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(){return(te=Object(N.a)(j.a.mark((function e(n){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t[n].id,e.next=3,A({variables:{id:a}});case 3:g({show:!1});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ne=t.map((function(e,t){var n={todo:e,index:t,handleMoveTodo:F,hideOnDrag:i,setHideOnDrag:c,setQuickEditStates:g,quickTodoEditRef:H};return o.a.createElement(L,Object(y.a)({key:e.order},n)," ")})),ae={handleMoveTodo:F,setHideOnDrag:c},oe={listLength:t.length,handleMoveTodo:F,setHideOnDrag:c,showNewTodo:f,handleShowNewTodo:function(){m(!0)},handlePreventNewTodoOnBlur:function(){P=!1},handleAddNewTodo:function(){O?Y():(U.current.focus(),P=!0)}},re={handleNewTodoOnBlur:function(){O?Y():P&&m(!1)},setNewTodo:v},ie={quickEditStates:E,setQuickEditStates:g,handleUpdateTodo:function(e,t){return ee.apply(this,arguments)},handleDeleteTodo:function(e){return te.apply(this,arguments)}};return o.a.createElement("div",null,o.a.createElement("div",{className:"d-flex justify-content-center"},o.a.createElement("div",{ref:J,onDragLeave:function(e){c(!1)},className:"card todo-list p-1"},o.a.createElement("div",{onDragLeave:function(e){return e.stopPropagation()},className:"div"},o.a.createElement(I,Object(y.a)({title:"Todo List"},ae)),o.a.createElement("div",{className:"card-body p-0"},o.a.createElement("div",null,ne),f?o.a.createElement(R,Object(y.a)({ref:U},re)):null),o.a.createElement(q,oe)))),E.show?o.a.createElement(B,Object(y.a)({ref:H},ie)):null)}Y.propTypes={todoItems:m.a.array};var Z=function(){var e=Object(X.b)(W.GET_TODO_LIST),t=e.loading,n=e.error,a=e.data;return t?o.a.createElement("div",null,"Loading..."):n?o.a.createElement("div",null,"Error :("):o.a.createElement(c.a,{backend:d.a},o.a.createElement(g,null," "),o.a.createElement(Y,{todoItems:a.list}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ee=n(49),te=n(11),ne=new ee.a({uri:"http://localhost:4000"});i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(te.a,{client:ne},o.a.createElement(Z,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[50,1,2]]]);
//# sourceMappingURL=main.1ea815cc.chunk.js.map